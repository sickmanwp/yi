'use strict';(function(){const indexCfg={cache:true};indexCfg.doc={id:'id',field:['title','content'],store:['title','href'],};const index=FlexSearch.create('balance',indexCfg);window.bookSearchIndex=index;index.add({'id':0,'href':'/bots/','title':"目錄",'content':"目錄 #    AVATAR   介绍 SCP-079-AVATAR 的使用方法   CAPTCHA   介绍 SCP-079-CAPTCHA 的使用方法   ID   介绍 SCP-079-ID 的使用方法   REGEX   介绍 SCP-079-REGEX 的使用方法   "});index.add({'id':1,'href':'/bots/avatar/','title':"AVATAR",'content':"AVATAR #  本文介绍如何使用 SCP-079-AVATAR 的机器人实例。\n 运作流程 #  以下介绍机器人的工作流程，在进行使用和设置前，建议您了解此流程。\n 加入群组 #  此机器人不接受任何群组的使用申请，群组也无法对此机器人进行设置，服务托管者自行决定此机器人加入哪些群组中。\nAVATAR 应加入成员人数较多的群组，其加入的群组推荐为 NOSPAM 机器人所在的群组，但不可加入 NOSPAM 所在的全部群组，避免机器人的真实身份被轻易识别。\n同时，我们建议 AVATAR 只加入管理员较为活跃的群组，以群组的管理员能够及时处理广告和举报、及时干预群组内的异常现象为宜。这样是为了保证由 AVATAR 自动生成的全局白名单具有一定的可靠性。\n分析头像 #  当用户加入群组时，AVATAR 会检查是否已向 NOSPAM 分享过此用户当前的头像：如已分享过，则不做操作；如未分享，则通过 EXCHANGE 频道向 NOSPAM 发送此用户当前的头像，以供分析。\n生成白名单 #  通过 AVATAR 加入的群组建立受信用户列表。每日更新。\n用户加入白名单的条件：\n 非黑名单用户 非受追踪的用户 评分不大于 1.2 无来自 NOFLOOD 和 WARN 的评分 未被 WARN 移除或封禁 加入群组超过一定时间 在自定义时段内的累计 “有效发言” 超过特定条数 有效发言：消息中包含的文本长度（不计 emoji 和部分字符）大于特定值，主动或被动删除的发言均算为无效发言 次日，该用户在自定义时间点仍为群组成员，并且未被管理员限制发言  依 config.ini 文件中的定义，添加白名单的过程可这样描述：\n AVATAR 将在每日的 time_check 点生成新的白名单用户列表。\n在 time_check 点之前，若用户在候选列表中，且仍为群组成员未被限制，则被加入白名单中。\n在 time_check 点之前，若用户不在候选列表中，但用户在 time_begin 到 time_end 这一时间段内，发送的有效消息条数超过 limit_message 条，则用户会被加入到候选列表中，待次日的 time_check 点判断最终是否应将其加入到白名单中。\n 白名单可作为操作等级的参考。不同机器人根据实际情况做不同的对待。例如白名单用户不会被各机器人操作升级，NOSPAM 的检查相对宽松，而 WATCH 则有可能因为白名单而不对用户进行追踪处理。\n 实用命令 #  以下介绍本机器人可响应的文字命令。\n SCP-079-TEST 中的成员 #   /version：通过 HIDE 间接检查机器人版本   问与答 #  常见问题汇总。\n Q：如何查询自己是否在白名单中？\nA：出于防 spam 的考虑，我们不对项目工作组以外的用户开放查询白名单的方式。\nQ：谁能控制白名单的添加？\nA：机器人是根据预设条件自动生成白名单的，即使是项目工作组内的管理员也无法手动添加具体的白名单用户。\nQ：谁能控制白名单的移除？\nA：群组的管理员通过 WARN 封禁或移除某个白名单用户时，该用户将被从白名单中移除，但不影响其在每月数据重置后再次被收录进白名单的可能。项目工作组成员通过 MANAGE 也可以移除某个用户的白名单，目前不会影响其今后被再次收录的可能性。当用户评分大于 1.8 时，也将被从白名单中自动移除。\n"});index.add({'id':2,'href':'/bots/captcha/','title':"CAPTCHA",'content':"CAPTCHA #  本文介绍如何使用 SCP-079-CAPTCHA 的机器人实例。\n 简介 #  本机器人提供对新入群用户的验证审核。群组如开启了免验证模式，用户在成功验证一次后，在一段时间内可以自动在多群免验证。并且，验证流程不会在群内呈现，多人进群也不会造成验证码的刷屏，本机器人力求以最简短最不干扰群组内正常交流的方式提醒用户进行验证。同时，为满足各群组的不同需求，本机器人同时支持设置自定义问题。\n 所需权限 #  机器人若需正常工作，则在群组中需要如图所示的权限，权限缺失可能将导致机器人退出群组：\n PERMISSONS：\n  运作流程 #  以下介绍机器人的工作流程，在进行使用和设置前，建议您了解此流程。\n注意\n 此处介绍的为机器人默认设置的流程，如需查看自定义问题的验证流程，请见「设置自定义问题」一节。 CAPTCHA 不会对已被管理员限制发言的用户发起验证。主要认为既然该用户被管理员限制发言，那么其是受到了特别处理的，机器人无需对其再次验证。另外避免个别群组同时使用两个验证机器人产生的问题。     提示部分 #  单个用户入群 #   机器人将禁言用户，同时机器人将回复用户的入群消息，提供一个按钮 前往验证 ，点击按钮会前往专用验证群组。 提示消息中默认以用户 ID 的形式 mention 该用户。群组可通过命令自定义该入群提示。   单用户入群时的默认提示：\n 多个用户入群 #   当多个用户入群时，机器人将禁言用户，同时机器人将回复用户的入群消息，提供两个按钮，左侧按钮为： 我需要验证吗 ，用户点击该按钮，机器人会用弹出窗口的形式回复该用户是否需要验证；右侧按钮为： 前往验证 ，点击按钮会前往专用验证群组。 在触发验证的原始群组中，用户验证提示消息只保留最后一条，因此即使多名用户短时间入群，群内也只有一条验证提示消息，该条验证提示消息会显示待验证的用户数量，同时，会以多个不可见的字符在消息内 @ 所有待验证的用户，通常情况下每个用户都能再次得到此条消息的通知提示，防止了稍早入群的待验证用户忽视该验证提示消息。群组可通过命令自定义该入群提示。   多用户入群时的常规提示：\n 待验证用户点击「我需要验证吗」按钮后，收到的提示：\n 验证部分 #  需要验证的用户加入专用验证群组中，会触发随机类别的问题——\n 文字形式的数学加减法运算（提供备选按钮） 图片形式的数字验证码（可更换问题） 图片形式的汉字成语验证码（可更换问题） 图片形式的英文字母验证码（可更换问题） 图片形式的看图辨物（提供备选按钮） 图片形式的数学加减法运算（提供备选按钮）（可更换问题） 图片形式的汉字验证码（提供备选按钮）（文字是与食品有关的名称）   举例：用户随机抽到的图片形式的数学加减法运算\n 如用户在有限时间内正确回答，即验证通过，用户在最初触发验证的群组中将被解除禁言。同时用户将在几分钟后于专用验证群组中被移除。提示中提供一键返回原群组的按钮，方便用户立即回到原待验证群组中。含有返回原群组链接的提示将于几十秒后于专用验证群组中自动删除。\n 验证通过后的提示：\n 如用户回答超时，或在有限时间内根本未加入专用验证群组，将导致验证失败。如用户在专用验证群组中回答超时，该用户将在 10 秒后于专用验证群组中移除。初次超时失败将在原始群组中封禁用户，10 分钟后解封，解封后用户可再次加入原始群组触发验证，如果第二次再次超时失败，将在原始群组中永久封禁该用户。\n 验证超时后的提示：\n 如用户回答错误，导致验证失败，用户将在 15 秒后在专用验证群组中被移除，错误提示中会留下建议，提醒用户在 10 分钟后可再次加入原始群组中触发验证。回答错误的同时，将在原始群组中封禁用户，10 分钟后解封，解封后用户可再次加入原始群组触发验证。尚未对该类失败的尝试次数做出限制。\n 验证失败后的提示：\n 无关人员 #  不需要验证的用户如果加入专用验证群组中，会被机器人踢出。有时用户反复入群，可能不会重复发送入群的服务消息（xxx joined the group），此时机器人将不能够立即踢出这名不需要验证的用户，但机器人会每 10 分钟获取专用验证群组的所有用户，对无关用户进行踢出操作。\n开放监督 #  所有 CAPTCHA 所在群组中的所有管理员，可随意加入专用验证群组中查看机器人运行情况。USER、LONG、和 CAPTCHA 将共同保证专用群组中没有任何多余消息。\n极端情况应对 #  在大量用户短时间内入群（炸群）时，机器人将触发自动静态消息模式，即，对用户入群消息实行立即删除的操作（不保留任何入群消息）。如果群组开启了自动置顶功能（默认开启），将在此时发送一条独立提示，并将此提示置顶，不再重复发送入群提示消息。当轰炸结束后，自动恢复群组的原置顶。\n跨机器人合作 #  与 NOSPAM 合作\nCAPTCHA 可以接收来自 NOSPAM 的针对某个用户的验证发起请求。当防广告的机器人 NOSPAM 判断用户应当被封禁时，如果经检查用户加入群组的时间较长，是一名 “老群员”，则将导致 “操作降级”。降级的操作将导致用户的消息被全局删除，但该用户不会被封禁；如果群组中存在 CAPTCHA ，则降级的操作可能不全局删除用户的消息（尽量保持对话的完整性），而是要求用户成功进行一次 CAPTCHA 验证后，方可正常发言。用户验证超时或失败仍旧会被 CAPTCHA 移出群组，10 分钟后解禁。\n与 TIP 合作\n当群组中有 TIP 机器人，CAPTCHA 会确保用户成功通过验证后，才通知 TIP 进行入群欢迎。\n 群组设置 #  以下介绍如何在群组中更改机器人的设置。\n 按钮设置 #  管理员在群内发送：\n/config captcha\n即可通过 SCP-079-CONFIG 方便地调整机器人设置，机器人将回报前往设置的链接，5 分钟内设置将被锁定，无法再次更改。请记得在完成设置后点击「提交」按钮。\n协助删除： 用户验证失败时，令 USER 协助删除该用户所发所有消息（包括该用户入群消息，同时避免机器人在特殊情况下遗漏在成功禁言前用户所发的其他消息）。\n禁言模式： 多次验证失败，导致永久惩罚时，选择禁言该用户，而不是封禁该用户。\n封禁模式： 首次验证失败，选择直接永久封禁该用户，而不在 600 秒后解禁该用户（不给用户再次尝试的机会）。\n自动解禁： 当某名用户在其他群组验证成功，选择自动解除该用户在您的群组中受到的永久性惩罚。\n入群提示： 如关闭，机器人将不会发送新用户入群时的验证提示。某些群组可能有这类需求。群组可以在提示关闭后，在置顶消息、群组描述中提供必要说明，并提供 @SCP_079_CAPTCHA 的链接，让用户入群后主动地加入专用群组中进行验证。如群组一定要选择关闭入群提示，我们更推荐管理员在群内发送 /static 命令获取一个永久有效的验证提示消息，该消息同样有两个按钮，群组可在置顶和群组描述中提供该条消息的链接，这样用户即可通过按钮更清楚自己是否需要验证（static 消息只适用于新加入用户有权限查看群组历史消息的情况）。\n自动免验证： 开启后，用户在某个群组验证通过一段时间后，将不会再次重复地在其他群组触发验证。即使关闭，用户也会在几分钟内不需验证，这是为了保证用户已被从专用验证群组中移除。\n自动置顶： 开启后，当群组短时间内进入大量用户时，机器人将不再重复发送入群验证提示，而是发送一条通用提示，并将此提示置顶，其后保持静默。当群组的入群频率恢复正常状态，并保持正常状态一定时间后，机器人将自动取消置顶，如果群组之前已有置顶，则自动恢复群组原有的置顶消息。置顶产生的服务消息将被 USER 自动删除，以期最小化对群组正常对话的影响\n自定义问题： 开启后，当群组设定了自定义问题时，机器人将选取指定的问题提问用户。详情请见「设置自定义问题」一节。\n仅手动： 开启后，新用户入群将不再触发验证流程。无论是否开启，管理员都可以使用 /captcha 命令回复某用户，要求该用户进行一次验证（但机器人判断用户不需重复验证时，不会有反应）。\n命令设置 #  除使用 /config captcha 外，管理员也可以通过 /config_captcha 命令在群组中手动调整设置：\n /config_captcha 功能代号 on|off：开启或关闭某功能 / 模式  功能代号如下：\n delete：协助删除 restrict：禁言模式 ban：封禁模式 forgive：自动解禁 hint：入群提示 pass：自动免验证 pin：自动置顶 qns：自定义问题 manual：仅手动  例如开启自动免验证功能：\n/config_captcha pass on\n 设置自定义提示 #  注意\n本节说明的是如何设置「自定义提示」，而不是「自定义问题」。   通过此命令可设置机器人所发送的验证提示：/custom 类别代号 自定义提示内容\n类别代号如下：\n flood：加群轰炸时的提示 manual：手动触发验证时的提示 nospam：NOSPAM 降级触发验证的提示 single：只有一名待验证用户时的提示 static：手动获取的静态消息的提示 multi：多名用户带验证时的提示  自定义内容中可以添加与用户相关的代号：\n $mention_id：此代号将自动被替换为用户的 ID 并 @ 该用户 $mention_name：此代号将自动被替换为用户昵称 并 @ 该用户 $code_id：代号将自动被替换为用户的 ID $code_name：此代号将自动被替换为用户的昵称 $code_count：此代号仅在 multi 类别下有效，将替换为待验证用户的数量，例如：3  注意事项：\n 当类别为 nospam 时，自定义内容应至少包含 $mention_id 和 $mention_name 中的一个 当类别为 flood 和 static 时，自定义内容不应该包含 $mention_id 或 $mention_name 仅当类别为 multi 时，$code_count 代号才会被有效替换 当设定自定义提示的样式时（链接、加粗、斜体、代码块），请内容遵从 HTML 格式，请见：https://docs.pyrogram.org/topics/text-formatting#html-style    示例，自定义单用户入群时的提示：\n/custom single 您好 $mention_name，请您点击下方按钮进行验证，以证明您不是机器人 本示例对应的效果：\n 如需查看某个类别的设置，可如此操作：/custom single\n 设置自定义问题 #  介绍如何设置自定义问题，以及说明自定义问题的验证流程。\n注意：\n 原则上我们不推荐群组使用自定义问题，建议群组有特殊需求时方才使用该功能。 设置自定义问题需要与机器人进行私聊。在设计原则上，私聊的设置无法得到「操作可查原则」的保证。因此，若群组开启自定义问题，则认为群组主动放弃这部分设置的公开可查性，因此机器人将对 /qns 命令做证据留存，转发至 LOGGING 频道中。 若群组使用自定义问题，则问题的难易度无法被托管者调控，当前群组验证通过与否对其他群组失去了参考价值，因此 CAPTCHA 将无法对用户产生评分，其他机器人也因此无法更好地评价用户的行为。 自定义问题并不能脱离群组进行验证。 使用自定义问题时，「自动免验证」功能将失效，因此对于用户来说无法减少重复验证。    自定义问题验证流程 #  单个用户入群 #   机器人将禁言用户，同时机器人将回复用户的入群消息，提供问题和备选答案。 提示消息中默认以用户 ID 的形式 mention 该用户。群组可通过命令自定义分割线前的入群提示。   单用户入群时的自定义问题：\n 多个用户入群 #   当多个用户入群时，机器人将禁言用户，同时机器人将回复用户的入群消息，提供问题和备选答案。 自定义问题模式下，入群提示仍保留叠加特性，由于提示和问题只保留最后一条，因此该多名用户所需回答的题目将保持一致。该条验证提示消息会显示待验证的用户数量，同时，会以多个不可见的字符在消息内 @ 所有待验证的用户。群组可通过命令自定义分割线前的入群提示。   多用户入群时的自定义问题：\n 回答正确 #  如待验证用户在有限时间内回答正确，机器人将对该用户解除禁言。同时，用户会收到机器人的弹窗提示，告知验证通过。该用户即可在群组中正常发言。\n回答错误 #  如待验证用户在有限时间内回答错误，机器人将封禁该用户 n 小时（其中 n = 2(m - 1) ，m 为验证失败次数）。同时，用户会收到机器人的弹窗提示，告知用户回答错误，验证失败，重试需要等待 n 小时。用户可在 n 小时后再次入群触发验证。\n待用户回答错误收到的弹窗提示：\n 如需直接永久封禁该用户，请开启「封禁模式」。\n验证超时 #  自定义问题的验证等待时间为 time_captcha 的二分之一。即，当 time_captcha 设置为 240 时（默认），自定义问题等待时间为 120 秒。超时将导致验证失败。\n因自定义问题超时导致的验证失败，机器人将封禁相应用户 24 * n 小时（其中 n = 2(m - 1) ，m 为验证失败次数）。用户可在 24 * n 小时后再次入群触发验证。\n如需直接永久封禁该用户，请开启「封禁模式」。\n启用自定义问题 #  进行设置前，应先启用自定义问题功能，管理员在群组中发送：/config_captcha qns on\n请求设置会话 #  管理员在群组中发送：/qns\n执行此命令后，将视为群组已主动放弃「操作可查原则」提供的保护。  机器人将回报前往设置的按钮：\n /qns 命令的回应：\n 点击回报的按钮与机器人展开私聊，如图：\n 通过按钮 /start：\n 该设置会话将维持 600 秒，期间该群组不接受其他管理员的自定义问题设置。若在本次会话中操作超时，则机器人不再会有任何响应。\n添加问题 #  添加问题时，命令为 /add，请使用一行三个加号 +++ 来分隔问题、正确答案、错误答案，如果正确答案或错误答案部分，有多个，则用换行分隔。例如：\n/add 问题描述 +++ 正确答案 1 正确答案 2 +++ 错误答案 1 错误答案 2 错误答案 3 注意事项：\n 问题描述不得超过 140 字。 单个答案长度不得超过 64 字节，换算即：以全部是汉字为例，字数不得超过 21 ；以全部是英文字符为例，字数不得超过 64。 正确答案和错误答案的总数不得超过 6 个。 群组自定义问题的总数不得超过 20 个。 当设定自定义问题的样式时（链接、加粗、斜体、代码块），请内容遵从 HTML 格式，请见：https://docs.pyrogram.org/topics/text-formatting#html-style 只有问题可以设置样式，答案不可设置样式    添加问题：\n 如图所示，若添加成功，则机器人将回复问题简述，消息下方的按钮仅供效果预览，点击任意按钮将导致按钮消失。\n编辑已有问题 #  编辑问题遵从的格式与添加问题类似，命令为 /edit，/edit 后要附加问题编号。例如：\n/edit 问题编号 问题描述 +++ 正确答案 1 正确答案 2 +++ 错误答案 1 错误答案 2 错误答案 3  编辑问题：\n 群组选择编辑问题而不是删除问题，是为了可保留该问题的统计数据。\n删除已有问题 #  删除问题的命令为 /remove，后跟问题编号，例如：/remove 问题编号\n 删除问题：\n 除使用 /remove 外，还可使用 /rm，效果相同。\n显示所有问题 #  显示问题的命令为：/show\n 显示所有问题：\n 如图，将显示该问题的详情，和在群组中的提出次数、通过率、参与率、答错率。\n 提出次数：机器人成功发送出问题的次数 通过率：通过验证人数占提出次数的百分比 参与率：参与回答问题（无论正确或失败）的人数占提出次数的百分比 答错率：回答错误的人数占参与回答问题人数的百分比  当问题数量大于 5 时，将自动以 TXT 文件的形式发送报告。如需手动要求以文件形式显示，则发送：/show file\n 以 TXT 文件形式显示所有问题：\n 设置自定义弹窗 #  通过此命令可设置机器人所发送的自定义问题的验证结果弹窗提示：/custom 类别代号 自定义弹窗提示内容\n类别代号如下：\n correct：回答正确后的弹窗提示 wrong：回答错误后的弹窗提示，可接受待等待时间（单位为小时）为参数，使用 {} 即可代表，例如：回答错误，您需要等待 {} 小时后重试   示例，自定义回答正确后的弹窗提示：\n/custom correct 回答正确，欢迎加入！  注意事项：\n 弹窗提示内容不得超过 140 字。 弹窗提示内容不可设置样式。   极端情况应对 #  在大量用户短时间内入群（炸群）时，机器人将回归常规验证模式，并采取常规验证模式的极端情况应对方法，要求所有待验证用户加入专用验证群组进行验证。\n 实用命令 #  以下介绍本机器人可响应的文字命令。\n 群组管理员 #   /captcha：手动对被回复的成员发起一次验证 /pass：回复某用户的入群消息，使该待验证用户跳过验证 /pass @username：令 username 为 @username 的用户在本群中通过验证。此命令亦可在用户尚未加群 / 验证失败时使用。 /pass 12345678：令用户 ID 为 12345678 的用户在本群中通过验证。此命令亦可在用户尚未加群 / 验证失败时使用。 /static：手动获取一条长期有效的静态验证提示，此提示可用于置顶或引用  SCP-079-CAPTCHA 中的成员 #   /pass：回复某用户的入群消息，使该待验证用户通过验证（对已验证失败的用户无效）  SCP-079-TEST 中的成员 #   /version captcha：检查机器人版本信息   问与答 #  常见问题汇总。\n Q：假设程序已经在中文模式下运行，如何满足英文群组的验证需求？\nA：同时利用自定义提示、自定义问题、自定义弹窗，可以做到验证环节无任何中文出现。\nQ：为什么在非自定义问题模式下，不在群内进行验证的全部流程？\nA：有时多个用户在短时间内入群，机器人的大量验证码反而会导致刷屏，对群内的正常对话造成很大干扰。而且，这种刷屏问题不符合项目 “最少发言” 的设计原则。\nQ：为什么不采取私聊机器人，而是在专用的验证群组中操作？\nA：私聊的验证是可行的，但同时带来了透明度问题。私聊导致机器人的验证流程无法可靠地受到监督，而在专用群组中，CAPTCHA 所在群组的所有管理员都可以随意加入，每个用户的验证流程都是对管理员们可见的，这种更直观的表达增加了机器人的透明度。同时，在群组中的直接展示，利于及时发现验证过程中出现的问题和错误。而且，这种私聊过程中的不透明性不符合项目 “操作可查” 的原则。\nQ：如果某用户连续加入了多个群组，触发了多个验证请求后，再去通过了验证，会发生什么？\nA：如在 “有限时间内” 通过了一次验证，该用户将同时在所有等待验证的群组中被解除限制（除设置自定义问题的群组外），均可正常发言。\nQ：在上一问题的答案中，机器人是如何计算 “有限时间内”？\nA：若连续加入了多个群组，则以最开始加入群组（除设置自定义问题的群组外）的时间点为起点，240 秒后为终点，在此期间完成验证才视为有效，否则将导致超时。\nQ：假设群组启用了自定义问题模式，当用户入群尚未回答问题的时候，群管修改或删除了该问题，或者群管关闭了自定义问题模式，机器人将如何处理该用户的验证？\nA：此情况下，无论用户点击哪个答案按钮，均将通过验证。\n"});index.add({'id':3,'href':'/bots/id/','title':"ID",'content':"ID #  本文介绍如何使用 SCP-079-ID 的机器人实例。\n 简介 #  本机器人可协助您获取用户、群组、频道的 ID。\n 实用命令 #  以下介绍本机器人可响应的文字命令。\n 私聊对话 #   /start 或 /help：显示帮助信息 /id：在与机器人的私聊对话中发送此命令，将获得您的用户 ID /id username：在与机器人的聊对话中发送此命令，将获得 @username 的 ID /id @username：在与机器人的聊对话中发送此命令，将获得 @username 的 ID /id https://t.me/username：在与机器人的聊对话中发送此命令，将获得 @username 的 ID  用户还可以转发消息到与机器人的私聊对话中：\n 转发频道消息：将获得该频道的 ID 转发用户消息：将获得该用户的 ID（如果该用户没有开启转发保护）   普通群组 #   /id：在群组中发送此命令，将获得您的用户 ID，群组 ID /id：在群组中以回复某用户消息的形式发送此命令，将获得您的用户 ID，被回复的用户 ID，和群组 ID  注 1：当检查 ID 时，还将同时检查该对象是否收到 Telegram 限制，如果受限，将同时显示受限理由等信息。\n注 2：如在群组中发送 /id 没有反应，请尝试将机器人设置为任意权限的管理员。\n  SCP-079-TEST 中的成员 #   /version id：检查 ID 机器人版本信息  "});index.add({'id':4,'href':'/bots/regex/','title':"REGEX",'content':"REGEX #  本文介绍如何使用 SCP-079-REGEX 的机器人实例。\n 简介 #  SCP-079 工作组 通过 SCP-079-REGEX 管理着 SCP-079 旗下所有机器人使用的正则表达式。\nREGEX 能方便地管理 SCP-079 系列的机器人所使用的正则表达式规则，若无 REGEX 配合，NOSPAM、WATCH、CLEAN 均将无法正常工作。\n SCP-079-REGEX 项目未公开本项目 REGEX 机器人实例所使用的正则表达式，且暂无公开的计划。 本文使用手册不讲述正则表达式的语法，请自行学习正则表达式的相关语法。 本文中假设 SCP-079 旗下所有机器人的所有功能均被开启，实际上本文所述的所有封禁、删除均受白名单、操作降级和群组对机器人的配置的共同调控。 本文中约定使用 \u0026amp;\u0026amp; 表示 且、|| 表示 或、( 和 ) 表示 运算的优先顺序   运作流程 #  以下介绍机器人的工作流程，在进行使用和设置前，建议您了解此流程。\n 维护方式 #  参与管理 REGEX 机器人的成员，均应在 SCP-079-REGEX 专用群组中进行操作，并在 SCP-079-TEST 中对所添加的规则进行测试。\n成员在 SCP-079-REGEX 群组中可以执行的操作有：\n 检索 添加 删除  生效方式 #  每执行添加或删除操作后，REGEX 将通过 EXCHANGE 频道，自动推送受影响的规则集给其他需要的机器人。\n统计 #  其他机器人将在每日定时地向 REGEX 通报所使用规则的触发情况，REGEX 将根据这些数据对规则进行排序、显示、自动清理。\n 规则集说明 #  下面将对 REGEX 支持的所有规则集做简要说明。\n 广告用语 #  规则集代号：ad ada adb adc \u0026hellip; adz\n注 1： 本文在此约定使用 ad* 指代 ada 规则集 到 adz 规则集 中的任意一个规则集。\n注 2： 触发 emoji 计数规则的视为触发了 ad*\n NOSPAM：  用户消息触发 (ad 规则集 || ad* 规则集) \u0026amp;\u0026amp; (con 规则集 || iml 规则集 || pho 规则集 || 联系方式收录) 时，将全局封禁触发者，并加入全局黑名单。 用户消息触发 ad* 规则集 中任意两个规则集时，将全局封禁触发者，并将其加入全局黑名单。    头像分析 #  规则集代号：ava\n NOSPAM：将使用该类规则分析用户头像 OCR 结果，若触发该类规则集，将导致该用户被全局封禁，并将其加入全局黑名单。  敏感检测 #  规则集代号：bad\n NOSPAM：用户消息触发此规则集，将更新用户评分，并自动举报至 WARN，令其提交至群组管理员处理。  自动封禁 #  规则集代号：ban\n NOSPAM：用户消息、昵称、头像、或简介触发此规则集，将全局封禁触发者，并将其加入全局黑名单。  简介检查 #  规则集代号：bio\n NOSPAM：用户昵称或简介触发此规则集，将全局封禁触发者，并将其加入全局黑名单。  联系方式 #  规则集代号：con\n NOSPAM：用户消息触发 (ad 规则集 || ad* 规则集) \u0026amp;\u0026amp; (con 规则集 || iml 规则集 || pho 规则集 || 联系方式收录) 时，全局封禁触发者，并加入全局黑名单。  自动删除 #  规则集代号：del\n NOSPAM：用户消息触发此规则集，将删除触发的消息，并更新该用户的评分。  文件名称 #  规则集代号：fil\n NOSPAM：用户发送消息中的文件名触发此规则集，将全局封禁该用户，并将其加入全局黑名单。  IM 链接 #  规则集代号：iml\n CLEAN：用于检测消息中是否含有 IM 链接 NOSPAM：用户消息触发 (ad 规则集 || ad* 规则集)\u0026amp;\u0026amp; (con 规则集 || iml 规则集 || pho 规则集 || 联系方式收录) 时，全局封禁触发者，并加入全局黑名单。  电话号码 #  规则集代号：pho\n CLEAN：用于检测消息中是否含有电话号码 NOSPAM：触发 (ad 规则集 || ad* 规则集 ) \u0026amp;\u0026amp; (con 规则集 || iml 规则集 || pho 规则集 || 联系方式收录) 时，全局封禁触发者，并加入全局黑名单。  名称封禁 #  规则集代号：nm\n NOSPAM：全局封禁触发者，并加入全局黑名单。  RM 笑话 #  规则集代号：rm\n TIP：回复触发消息，提示他人谨慎执行该操作。  短链接 #  规则集代号：sho\n CLEAN：用于检测消息中是否包含短链接。  特殊中文 #  规则集代号：spc\n 大部分机器人：用于 normalize 文本 LANG：用于判断特殊中文  特殊英文 #  规则集代号：spe\n 大部分机器人：用于 normalize 文本 LANG：用于判断特殊中文  贴纸删除 #  规则集代号：sti\n NOSPAM：用于判断贴纸是否在推广贴纸包中。  Telegram 链接 #  规则集代号：tgl\n CLEAN：用于判断消息中是否含有 Telegram 链接。  Telegram 代理 #  规则集代号：tgp\n CLEAN：用于判断消息中是否含有与 Telegram 有关的代理。  追踪封禁 #  规则集代号：wb\n NOSPAM：用于进行追踪封禁 WATCH：用于进行封禁追踪 其他部分机器人：用于在特殊情形下检查昵称  追踪删除 #  规则集代号：wd\n NOSPAM：用于进行追踪删除 WATCH：用于进行删除追踪  测试用例 #  规则集代号：test\n REGEX：SCP-070-TEST 群组成员可发送消息至 SCP-070-TEST 群组检测是否匹配正则表达式   检索正则表达式 #  以下介绍 REGEX 所支持的检索正则表达式的方法。注意：操作应在 SCP-079-REGEX 群组中进行。\n 查阅全部 #  您可使用 /ls 规则集代号 显示该规则集中的全部内容，该列表默认按照平均触发次数的降序排列。\n使用 /ls 规则集代号 asc 将按照平均出发次数的升序显示该规则集。\n搜索 #  您可使用 /search 规则集代号 内容、/s 规则集代号 内容 或 /find 规则集代号 内容。\n除已有的规则集代号外，这三个命令均支持规则集代号 all 来搜索所有规则集。\n标签说明 #  正则表达式使用 (?#注释内容) 表示注释。REGEX 使用正则表达式注释语法为正则表达式附加标签信息。\n目前，支持的标签有：\n 同步标签：(?# 规则集代号1 规则集代号2 规则集代号3)  对含有同步标签的正则表达式进行操作时，SCP-079-REGEX 会在同步标签中的每个规则集中重复执行。   临时标签：(?# temp) [该功能即将被调整]  REGEX 会自动追踪包含临时标签的正则表达式的触发情况，如该正则表达式连续 14 日不被触发，其将被自动移除。 ban 规则集 的任意规则均视为附加了临时标签，如不希望 ban规则集 中的正则表达式表示式因连续14日不被触发而被移除，请使用永久标签 (?# forever)   若需要某条正则表达式不在OCR结果中生效，请使用(?#nocr)  注:正则表达式注释语法(?#注释内容)中，并未要求注释内容与#间要有一个空格，但为了美观SCP-079-REGEX会在此自动加上一个空格。\n 添加与删除正则表达式 #  此处介绍如何添加或删除规则。注意：操作应在 SCP-079-REGEX 群组中进行。\n 添加正则表达式 #  在 SCP-079-REGEX 群组中通过 /add 任意规则集代号 正则表达式 或 /ad 任意规则集代号 正则表达式 添加正则表达式\n例如，分别发送以下两条命令：\n/add wb 专业引流 /ad del 1a2b3c4d5e6f 在同规则集中添加与已有正则表达式近似的正则表达式时，将触发替换询问。\n如需将相同的正则表达式添加至多个规则集中，可使用 /same 规则集代号1 规则集代号2 规则集代号3 规则集代号4 回复某 /add 命令完成。示例如下：\n在执行完 /ad del 1a2b3c4d5e6f 后，1a2b3c4d5e6f 被添加进了 del 规则集，此时若需将 1a2b3c4d5e6f 同时加入 nm 规则集，只需用 /same nm 这个命令来回复之前的那条 /ad del 1a2b3c4d5e6f 消息即可；\n若此时又需将 1a2b3c4d5e6f 加入 ad 规则集 和 test 规则集，只需再次用 /same ad test 命令来回复之前的那条 /ad del 1a2b3c4d5e6f 消息即可。\n该情景下的操作还可进一步简化：REGEX 会读取正则表达式中的注释部分，只需使用注释注明包含该正则表达式的所有规则集即可。\n例如该情景下使用 /ad del 1a2b3c4d5e6f(?# del nm ad test) 即可一键将 1a2b3c4d5e6f(?# del nm ad test) 加入 del 规则集、nm 规则集、ad 规则集、test 规则集。\n  删除正则表达式 #  在 SCP-079-REGEX 群组中通过 /remove 任意规则集代号 正则表达式 或 /rm 任意规则集代号 正则表达式 可删除某正则表达式。\n例如，分别发送以下两条命令：\n/remove wb 专业引流 /rm del 1a2b3c4d5e6f 如需将相同的正则表达式从多个规则集中删除，可使用 /same 规则集代号1 规则集代号2 规则集代号3 规则集代号4 回复某 /remove 命令完成。示例如下：\n在执行完 /rm del 1a2b3c4d5e6f 后，1a2b3c4d5e6f 将从 del 规则集 中被删除，此时若需将 1a2b3c4d5e6f 同时从 nm 规则集 删除，只需用 /same nm 这条命令回复之前的那条 /rm del 1a2b3c4d5e6f 消息即可；\n若此时又需将 1a2b3c4d5e6f 从 ad 规则集 和 test 规则集 中删除，只需再次用 /same ad test 这条命令回复之前的那条 /rm del 1a2b3c4d5e6f 消息即可。\n该情景下的操作还可进一步简化：REGEX 会读取正则表达式中的注释部分，只需使用注释注明包含该正则表达式的所有规则集即可。\n例如该情景下使用 /rm del 1a2b3c4d5e6f(?# del nm ad test) 即可一键将 1a2b3c4d5e6f(?# del nm ad test) 从 del 规则集、nm 规则集、ad 规则集、test 规则集 中删除。\n  测试表达式 #  本节介绍如何测试正则表达式。注意：操作应在 SCP-079-TEST 群组中进行。\n 触发测试 #  SCP-079-TEST 群组中成员可通过发送或转发待测试的消息测试当前文本所触发的正则表达式。\nREGEX 机器人将读取消息正文、来源名称、贴纸包标题、贴纸名称，并检查相关正则表达式，并在 SCP-079-TEST 群组中输出被触发的正则表达式列表。\n 其他命令说明 #   /comment ad* 注释内容：使用该命令为ad*规则集添加注释  例如：/comment ada 黑产 注释内容不会影响其他机器人的运行，仅在 /ls 命令出发的列表和 SCP-079-MANAGE 群组成员使用 /status regex 回复的列表中显示。   /count：要求其他机器人立刻回报当日统计数据 /ls [word_type]：显示word_type类别的规则列表，后面不跟类别则显示已有的所有类别及代号 /push [word_type]：手动推送某类规则，若 [word_type] 为 all，则推送全部规则 /reset [word_type]：清除某类规则计数数据，若 [word_type] 为 all，则清除全部规则计数  理念 #  本节介绍使用 REGEX 管理本项目机器人使用的正则表达式的部分理念，该节内容仅供参考。\n注： 本节内容为部分管理员观点，未与 SCP-079 工作组其他管理员讨论，不代表 SCP-079 工作组的建议，仅供参考。\n 组合规则 #  正则表达式不考虑消息的语境，易出现错误，我们建议对于触发后可能产生高危操作的规则集，例如封禁，应当尽量使用多条正则表达式组合，减少机器人仅依靠单条正则表达式做出封禁的决定。\nad* 规则集 间，ad* 规则集与 con 规则集、iml 规则集、pho 规则集 间，以及 ad 规则集与 ad* 规则集 与 con 规则集、iml 规则集、pho 规则集 间，均应当避免重叠，否则将易产生误判。\n寻找通用特征、宁缺毋滥 #  受限于多种因素，正则表达式很难处理所有类型的广告，SCP-079-REGEX 群组成员应该考虑该正则表达式的目标与预期效果，为了过于少见的情况花费过多的精力是不必的（我们的目标是为群组管理员提供帮助，而非代替群组管理员）。SCP-079-REGEX 群组成员应当正视该现象，SCP-079-REGEX 群组成员应该处理的广告须符合两个原则中任意一个：\n 含有通用特征，易于处理 虽不含通用特征，但短期内大量出现  SCP-079-REGEX 群组成员应该追求识别效果与成本（包括人力、错误风险、服务器性能等）的平衡。\nSCP-079-REGEX 群组成员在添加正则表达式时应该寻找某类广告的通用特征，而非个例特征（这需要 SCP-079-REGEX 群组成员多观察广告样本的特征）。过度使用依赖个例特征的正则表达式会大大降低 NOSPAM 的识别能力与抗干扰能力。但是寻找广告的通用特征往往比寻找广告的个例特征困难，因此我们建议将两者结合使用。应该以依赖通用特征的正则表达式为主的同时，同时以依赖个例特征的正则表达式为辅助，用于处理未被长期有效的正则表达式识别的短期内大量出现的广告内容。根据我们的实践经验，依赖个例特征的正则表达式失效速度较快，Spammer 总是擅于逃避正则表示的检测，因此依赖个例特征的正则表达式应该为短期规则，通常应该添加 temp标签。\n当遇到未能识别的广告内容时，请优先尝试寻找该类广告的通用特征，如果很难找到该类广告的通用特征且该类广告并非大量出现，则不必考虑该类广告的个例特征，此时最好的做法是——什么也不做。\n 联系方式收录机制 #  SCP-079-NOSPAM 将根据 REGEX 添加的规则执行联系方式收录，详情如下。\n 得益于腾讯公司的较为严格的账号控制政策，Spammer 通常不能频繁更换 QQ 账户、Wechat 账户，该内容足以作为寻找 Spammer 的重要特征，因此 SCP-079-NOSPAM 会于已被其封禁的用户的消息中根据正则表达式寻找并收录 Spammer 的联系方式。昵称或简介中出现已收录的联系方式的用户将被NOSPAM封禁，\nNOSPAM 将提取正则表示式中名为 con 的捕获组，并去除其中可能存在的空白字符。\n例如，在 SCP-079-REGEX 群组中分别发送以下两条命令：\n/add con QQ号码为：(?P\u0026lt;con\u0026gt;\\d{4,}) /add ad a1b2c3d4 注 1： 以上内容仅为示例，实际环境中检测 QQ 号 的正则表达式远比该示例复杂。\n然后在使用 NOSPAM 的群组中发送\na1b2c3d4 QQ号码为：123456789 将导致 NOSPAM 封禁该用户，并记录该联系方式 123456789，记录结果将于证据存放频道公示。\nSCP-079-MANAGE 群组成员可使用 /remove_contact 具体联系方式 来移除已收录的联系方式（例如：/remove_contact 123456789）。即使不通过命令手动移除，收录的联系方式也将于一定时间后自动清空。\n注 2： 未实际导致用户遭受封禁则不进行联系方式收录。\n注 3： NOSPAM 将只收集 con 规则集、iml 规则集、pho 规则集中名为 con 的捕获组，NOSPAM 不会收录除此三者之外的其他规则集中的 con 的捕获组，也不收录 con 规则集、iml 规则集、pho 规则集中的其他 tag 的捕获组。\n注 4： NOSPAM 不收录少于 6 字符的联系方式，防止内容过短而导致的误判。\n 问与答 #  常见问题汇总。\n Q：为什么 pho规则集 与 iml规则集 要从 con规则集 中分离呢?\nA：CLEAN 需要单独使用 pho规则集 和 iml规则集\nQ：为什么应该使用 (?# temp) 标签？何时该使用该标签？\nA：使用该标签能减少失效和错误的正则表达式被长期保存，减少服务器压力和正则表达式维护难度\n"});})();